<!DOCTYPE html><html class="theme-lattice"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>向强大的SVG迈进 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="format-detection" content="telephone=yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="URL编码,preserveAspectRatio,viewBox,viewport,iconfont,foreignObject,百分号编码,svg,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2020/06/09/strong-svg/index.html"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon-48x48.png"><link rel="manifest" href="/img/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#2f83cd"><meta name="application-name" content="Aotu.io"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/img/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/img/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Aotu.io"><meta name="msapplication-TileColor" content="#fff"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-config" content="/img/browserconfig.xml"><meta property="wb:webmaster" content="a1686eb81db284d5"><meta name="wechat-logo" content="http://img20.360buyimg.com/aotucms/jfs/t1/115112/29/10318/58090/5ee87c4cE618547e0/3dbaa17ba41b6281.jpg"><meta name="wechat-title" content="向强大的SVG迈进"><meta name="wechat-desc" content="“强大如SVG，走遍千里，海阔天空，过来瞧一瞧看一看啦，大甩卖啦！”"><link rel="dns-prefetch" href="//storage.360buyimg.com"><link rel="dns-prefetch" href="//img10.360buyimg.com"><link rel="dns-prefetch" href="//img11.360buyimg.com"><link rel="dns-prefetch" href="//img12.360buyimg.com"><link rel="dns-prefetch" href="//img13.360buyimg.com"><link rel="dns-prefetch" href="//img14.360buyimg.com"><link rel="dns-prefetch" href="//img20.360buyimg.com"><link rel="dns-prefetch" href="//img30.360buyimg.com"><link rel="dns-prefetch" href="//misc.aotu.io"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="SVG 即 Scalable Vector Graphics 可缩放矢量图形，使用XML格式定义图形。  一、SVG印象SVG 的应用十分广泛，得益于 SVG 强大的各种特性。 1.1、 矢量可利用 SVG 矢量的特点，描出深圳地铁的轮廓： 1.2、iconfontSVG 可依据一定的规则，转成 iconfont 使用： 1.3、 foreignObject利用 SVG 的 foreignOb"><meta name="keywords" content="svg,百分号编码,foreignObject,iconfont,viewport,viewBox,preserveAspectRatio,URL编码"><meta property="og:type" content="article"><meta property="og:title" content="向强大的SVG迈进"><meta property="og:url" content="https://aotu.io/notes/2020/06/09/strong-svg/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="SVG 即 Scalable Vector Graphics 可缩放矢量图形，使用XML格式定义图形。  一、SVG印象SVG 的应用十分广泛，得益于 SVG 强大的各种特性。 1.1、 矢量可利用 SVG 矢量的特点，描出深圳地铁的轮廓： 1.2、iconfontSVG 可依据一定的规则，转成 iconfont 使用： 1.3、 foreignObject利用 SVG 的 foreignOb"><meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://img30.360buyimg.com/aotucms/jfs/t1/123459/10/4455/318920/5edd97c0Edbd5b5b3/66937ca47fc1afe3.png"><meta property="og:image" content="https://img13.360buyimg.com/aotucms/jfs/t1/125246/5/4320/95836/5edd9902E20137d44/6ecd5b02e93c929c.png"><meta property="og:image" content="https://img13.360buyimg.com/aotucms/jfs/t1/128190/34/5097/62748/5ee9863fE0a48bd0f/ee15c0c4e78154b3.gif"><meta property="og:image" content="https://img13.360buyimg.com/aotucms/jfs/t1/148917/37/231/39312/5edf0573E98170a53/81b67b2caea3b7f3.png"><meta property="og:image" content="http://img10.360buyimg.com/aotucms/jfs/t1/136508/7/1800/40826/5edf266bE89986311/99a12bd15aa88d41.png"><meta property="og:image" content="https://img20.360buyimg.com/aotucms/jfs/t1/128901/30/4507/95464/5edee81aEcf9d62db/5c23892e2b8a8750.jpg"><meta property="og:image" content="https://img10.360buyimg.com/aotucms/jfs/t1/124173/35/4413/306463/5edeeaabE44e34aee/cce4d92deaa82205.png"><meta property="og:image" content="https://img30.360buyimg.com/aotucms/jfs/t1/144844/4/250/122629/5edeee26Ecaf3f9e2/563e5a1b6e4558e9.png"><meta property="og:image" content="https://img11.360buyimg.com/aotucms/jfs/t1/135757/3/1754/221618/5edef0b3E2c314ea6/6903392e13c1b09e.png"><meta property="og:image" content="https://img11.360buyimg.com/aotucms/jfs/t1/113914/35/9595/221796/5edef024Ec0d99219/e4c1798de6668b20.png"><meta property="og:image" content="https://img11.360buyimg.com/aotucms/jfs/t1/137386/13/1850/158455/5edef14dEddc2c2cc/a422f4c2615fd20c.png"><meta property="og:image" content="https://img13.360buyimg.com/aotucms/jfs/t1/122876/5/4427/27028/5edef2a3E384682c0/5ea522ad8317fa02.png"><meta property="og:image" content="https://img10.360buyimg.com/aotucms/jfs/t1/115005/28/9686/226306/5edef501E42d87ffe/5a462a211ecf8ea0.png"><meta property="og:image" content="https://img30.360buyimg.com/aotucms/jfs/t1/137211/36/1825/52183/5edef616E99a0eb6e/643cbb12852b7e47.png"><meta property="og:image" content="https://img10.360buyimg.com/aotucms/jfs/t1/117322/1/9804/99241/5edefd7bE190a83a8/95d679fc4af312e9.png"><meta property="og:updated_time" content="2020-08-25T03:05:37.727Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="向强大的SVG迈进"><meta name="twitter:description" content="SVG 即 Scalable Vector Graphics 可缩放矢量图形，使用XML格式定义图形。  一、SVG印象SVG 的应用十分广泛，得益于 SVG 强大的各种特性。 1.1、 矢量可利用 SVG 矢量的特点，描出深圳地铁的轮廓： 1.2、iconfontSVG 可依据一定的规则，转成 iconfont 使用： 1.3、 foreignObject利用 SVG 的 foreignOb"><meta name="twitter:image" content="https://img30.360buyimg.com/aotucms/jfs/t1/123459/10/4455/318920/5edd97c0Edbd5b5b3/66937ca47fc1afe3.png"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script><script>window.WechatShareData={imgUrl:"http://img20.360buyimg.com/aotucms/jfs/t1/115112/29/10318/58090/5ee87c4cE618547e0/3dbaa17ba41b6281.jpg",link:window.location.href,title:"向强大的SVG迈进",desc:"“强大如SVG，走遍千里，海阔天空，过来瞧一瞧看一看啦，大甩卖啦！”"},window.WechatJSSDKURL="https://aotu.jd.com/aotu-wx-api/api/wx/jssdk/signature"</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://geeks.aotu.io" class="main-nav-link">极客沙龙</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="http://img20.360buyimg.com/aotucms/jfs/t1/115112/29/10318/58090/5ee87c4cE618547e0/3dbaa17ba41b6281.jpg" alt="向强大的SVG迈进"></div><header class="post-hd"><h1 class="post-tit">向强大的SVG迈进</h1><div class="post-meta">by <a target="_blank" href="https://github.com/Newcandy" class="post-author">暖暖</a> on <span>2020-06-09</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>“强大如SVG，走遍千里，海阔天空，过来瞧一瞧看一看啦，大甩卖啦！”</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><a id="more"></a><blockquote><p>SVG 即 Scalable Vector Graphics 可缩放矢量图形，使用XML格式定义图形。</p></blockquote><h2 id="一、SVG印象" class="post-heading"><a href="#一、SVG印象" class="headerlink" title="一、SVG印象"></a>一、SVG印象<a class="post-anchor" href="#一、SVG印象" aria-hidden="true"></a></h2><p>SVG 的应用十分广泛，得益于 SVG 强大的各种特性。</p><h4 id="1-1、-矢量" class="post-heading"><a href="#1-1、-矢量" class="headerlink" title="1.1、 矢量"></a>1.1、 矢量<a class="post-anchor" href="#1-1、-矢量" aria-hidden="true"></a></h4><p>可利用 SVG 矢量的特点，描出深圳地铁的轮廓：<br><img src="https://img30.360buyimg.com/aotucms/jfs/t1/123459/10/4455/318920/5edd97c0Edbd5b5b3/66937ca47fc1afe3.png" alt="深圳地铁"></p><h4 id="1-2、iconfont" class="post-heading"><a href="#1-2、iconfont" class="headerlink" title="1.2、iconfont"></a>1.2、iconfont<a class="post-anchor" href="#1-2、iconfont" aria-hidden="true"></a></h4><p>SVG 可依据一定的规则，转成 iconfont 使用：<br><img src="https://img13.360buyimg.com/aotucms/jfs/t1/125246/5/4320/95836/5edd9902E20137d44/6ecd5b02e93c929c.png" alt="截图来自iconfont.cn"></p><h4 id="1-3、-foreignObject" class="post-heading"><a href="#1-3、-foreignObject" class="headerlink" title="1.3、 foreignObject"></a>1.3、 foreignObject<a class="post-anchor" href="#1-3、-foreignObject" aria-hidden="true"></a></h4><p>利用 SVG 的 <code>foreignObject</code> 标签实现截图功能，原理：<code>foreignObject</code> 内部嵌入 HTML 元素：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">foreignObject</span> <span class="attr">width</span>=<span class="string">"120"</span> <span class="attr">height</span>=<span class="string">"60"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-size:20px;margin:0;"</span>&gt;</span>凹凸实验室 欢迎您<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">foreignObject</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>截图实现流程：</p><ol><li>首先声明一个基础的 svg 模版，这个模版需要一些基础的描述信息，最重要的，它要有 <code>&lt;foreignObject&gt;&lt;/foreignObject&gt;</code> 这对标签；</li><li>将要渲染的 DOM 模版模版嵌入 <code>foreignObject</code> 即可；</li><li>利用 <code>Blob</code> 构建 svg 对象；</li><li>利用 <code>URL.createObjectURL(svg)</code> 取出 URL。</li></ol><h4 id="1-4、SVG-SMIL" class="post-heading"><a href="#1-4、SVG-SMIL" class="headerlink" title="1.4、SVG SMIL"></a>1.4、SVG SMIL<a class="post-anchor" href="#1-4、SVG-SMIL" aria-hidden="true"></a></h4><p>由于微信编辑器不允许嵌入 <code>&lt;style&gt;&lt;script&gt;&lt;a&gt;</code> 标签，利用SVG SMIL 可进行微信公众号极具创意的图文排版设计，包括动画与交互。<br>但是也要注意，标签里不允许有id，否则会被过滤或替换掉。</p><p>点击 “凹凸实验室” 后，围绕 “凹凸实验室” 中心旋转 360度，点击0.5秒后 出现 <a href="https://aotu.io/">https://aotu.io/</a> ，动画只运行一次。</p><p>下图为 GIF循环演示：</p><p><img src="https://img13.360buyimg.com/aotucms/jfs/t1/128190/34/5097/62748/5ee9863fE0a48bd0f/ee15c0c4e78154b3.gif" alt="SVG SMIL"></p><p>代码如下：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"360"</span> <span class="attr">height</span>=<span class="string">"300"</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 点击后 运行transform旋转动画，restart="never"表示只运行一次 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">"transform"</span> <span class="attr">type</span>=<span class="string">"rotate"</span> <span class="attr">begin</span>=<span class="string">"click"</span> <span class="attr">dur</span>=<span class="string">"0.5s"</span> <span class="attr">from</span>=<span class="string">"0 100 80"</span> <span class="attr">to</span>=<span class="string">"360 100 80"</span>  <span class="attr">fill</span>=<span class="string">"freeze"</span> <span class="attr">restart</span>=<span class="string">"never"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">"microsoft yahei"</span> <span class="attr">font-size</span>=<span class="string">"20"</span> <span class="attr">x</span>=<span class="string">"50"</span> <span class="attr">y</span>=<span class="string">"80"</span>&gt;</span></span><br><span class="line">                凹凸实验室</span><br><span class="line">            <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">g</span> <span class="attr">style</span>=<span class="string">"opacity: 0;"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 同一个初始位置以及大致的宽高，触发点击事件 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">font-family</span>=<span class="string">"microsoft yahei"</span> <span class="attr">font-size</span>=<span class="string">"20"</span> <span class="attr">x</span>=<span class="string">"50"</span> <span class="attr">y</span>=<span class="string">"80"</span>&gt;</span>https://aotu.io/<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 点击后 运行transform移动动画，改变文本的位置 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">attributeName</span>=<span class="string">"transform"</span> <span class="attr">type</span>=<span class="string">"translate"</span> <span class="attr">begin</span>=<span class="string">"click"</span> <span class="attr">dur</span>=<span class="string">"0.1s"</span> <span class="attr">to</span>=<span class="string">"0 40"</span>  <span class="attr">fill</span>=<span class="string">"freeze"</span> <span class="attr">restart</span>=<span class="string">"never"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 点击0.5秒后 运行opacity显示动画 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">"opacity"</span> <span class="attr">begin</span>=<span class="string">"click+0.5s"</span> <span class="attr">from</span>=<span class="string">"0"</span> <span class="attr">to</span>=<span class="string">"1"</span> <span class="attr">dur</span>=<span class="string">"0.5s"</span> <span class="attr">fill</span>=<span class="string">"freeze"</span> <span class="attr">restart</span>=<span class="string">"never"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>以上是鄙人对SVG的大致印象，最近的需求开发再次刷新了我的认知，那就是 SVG实现非比例缩放 以及 小程序不支持SVG标签的处理，下面容我来讲述一番。</p><h2 id="二、SVG-实现非比例缩放" class="post-heading"><a href="#二、SVG-实现非比例缩放" class="headerlink" title="二、SVG 实现非比例缩放"></a>二、SVG 实现非比例缩放<a class="post-anchor" href="#二、SVG-实现非比例缩放" aria-hidden="true"></a></h2><p>我们熟知的 iconfont，可通过改变字体大小缩放，但是这是 比例缩放，那如何实现 SVG 的非比例缩放呢？<br>如下图所示，如何将 一只兔子 非比例缩放？</p><p><img src="https://img13.360buyimg.com/aotucms/jfs/t1/148917/37/231/39312/5edf0573E98170a53/81b67b2caea3b7f3.png" alt="兔子非比例缩放"></p><p><strong>划重点：实现非比例缩放主要涉及三个知识点：viewport、viewBox和preserveAspectRatio，viewport 与viewBox 结合可实现缩放的功能，viewBox 与 preserveAspectRatio 结合可实现非比例的功能。</strong></p><h4 id="2-1、viewport" class="post-heading"><a href="#2-1、viewport" class="headerlink" title="2.1、viewport"></a>2.1、viewport<a class="post-anchor" href="#2-1、viewport" aria-hidden="true"></a></h4><p><code>viewport</code> 表示SVG可见区域的大小。<br><code>viewport</code> 就像是我们的显示器屏幕大小，超出区域则隐藏，原点位于左上角，x 轴水平向右，y 轴垂直向下。</p><p><img src="http://img10.360buyimg.com/aotucms/jfs/t1/136508/7/1800/40826/5edf266bE89986311/99a12bd15aa88d41.png" alt="viewport"></p><p>通过类似CSS的属性 <code>width</code>、<code>height</code> 指定视图大小：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"200"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-2、viewBox" class="post-heading"><a href="#2-2、viewBox" class="headerlink" title="2.2、viewBox"></a>2.2、viewBox<a class="post-anchor" href="#2-2、viewBox" aria-hidden="true"></a></h4><p>viewBox值有4个数字：x, y, width, height 。<br>其中 x：左上角横坐标，y：左上角纵坐标，width：宽度，height：高度。<br>原点默认位于左上角，x 轴水平向右，y 轴垂直向下。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"200"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 200 100"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>显示器屏幕的画面，可以特写，可以全景，这就是 <code>viewBox</code>。<br><code>viewBox</code> 可以想象成截屏工具选中的那个框框，和 <code>viewport</code> 作用的结果就是 把框框中的截屏内容再次在 显示器 中全屏显示。</p><p><img src="https://img20.360buyimg.com/aotucms/jfs/t1/128901/30/4507/95464/5edee81aEcf9d62db/5c23892e2b8a8750.jpg" alt="理解 viewport 与 viewbox"><br>（图片来源：<a href="https://www.oxxostudio.tw/articles/201409/svg-23-viewpoint-viewBox.html" target="_blank" rel="noopener">SVG 研究之路 (23) - 理解 viewport 與 viewbox</a>）</p><h4 id="2-3、preserveAspectRatio" class="post-heading"><a href="#2-3、preserveAspectRatio" class="headerlink" title="2.3、preserveAspectRatio"></a>2.3、preserveAspectRatio<a class="post-anchor" href="#2-3、preserveAspectRatio" aria-hidden="true"></a></h4><p>上图的红色框框和蓝色框框，恰好和显示器的比例相同，如果是下图的绿色框框，怎样在显示器屏幕中显示呢？<br><img src="https://img10.360buyimg.com/aotucms/jfs/t1/124173/35/4413/306463/5edeeaabE44e34aee/cce4d92deaa82205.png" alt="如何非比例缩放"></p><h5 id="2-3-1、-定义" class="post-heading"><a href="#2-3-1、-定义" class="headerlink" title="2.3.1、 定义"></a>2.3.1、 定义<a class="post-anchor" href="#2-3-1、-定义" aria-hidden="true"></a></h5><p><code>preserveAspectRatio</code> 作用的对象是 <code>viewBox</code>，使用方法如下：<br></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">preserveAspectRatio=<span class="string">"[defer] &lt;align&gt; [&lt;meetOrSlice&gt;]"</span></span><br><span class="line">// 例如 preserveAspectRatio=<span class="string">"xMidYMid meet"</span></span><br></pre></td></tr></table></figure><p></p><p>其中 defer 此时不是重点，暂且忽略，主要了解 <code>align</code> 和 <code>meetOrSlice</code> 的 用法：</p><ul><li><code>align</code>：由两个名词组成，分别代表 viewbox 与 viewport 的 x 方向、y方向的对齐方式。</li></ul><table><thead><tr><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>xMin</code></td><td>viewport 和 viewBox 左边对齐</td></tr><tr><td><code>xMid</code></td><td>viewport 和 viewBox x轴中心对齐</td></tr><tr><td><code>xMax</code></td><td>viewport 和 viewBox 右边对齐</td></tr><tr><td><code>YMin</code></td><td>viewport 和 viewBox 上边缘对齐。注意Y是大写。</td></tr><tr><td><code>YMid</code></td><td>viewport 和 viewBox y轴中心点对齐。注意Y是大写。</td></tr><tr><td><code>YMax</code></td><td>viewport 和 viewBox 下边缘对齐。注意Y是大写。</td></tr></tbody></table><ul><li><code>meetOrSlice</code>：表示如何维持高宽的比例，有三个值 meet、slice、none。<ul><li><code>meet</code> - 默认值，保持纵横比缩放 viewBox 适应 viewport，可能会有余留的空白。</li><li><code>slice</code> - 保持纵横比同时比例小的方向放大填满 viewport，超出的部分被剪裁掉。</li><li><code>none</code> - 扭曲纵横比以充分适应 viewport。</li></ul></li></ul><h5 id="2-3-2、-例子" class="post-heading"><a href="#2-3-2、-例子" class="headerlink" title="2.3.2、 例子"></a>2.3.2、 例子<a class="post-anchor" href="#2-3-2、-例子" aria-hidden="true"></a></h5><p>例子1：<code>preserveAspectRatio=&quot;xMidYMid meet&quot;</code> 表示 绿色框框 与 显示器的 x 方向、y方向的 中心点 对齐；<br><img src="https://img30.360buyimg.com/aotucms/jfs/t1/144844/4/250/122629/5edeee26Ecaf3f9e2/563e5a1b6e4558e9.png" alt="xMidYMin slice"></p><p>例子2：<code>preserveAspectRatio=&quot;xMidYMin slice&quot;</code> 表示 绿色框框 与 显示器的 x 方向 中心点 对齐，Y 方向 上边缘对齐，保持比例放大填满 显示屏 后超出部分隐藏；<br><img src="https://img11.360buyimg.com/aotucms/jfs/t1/135757/3/1754/221618/5edef0b3E2c314ea6/6903392e13c1b09e.png" alt="例子2"></p><p>例子3：<code>preserveAspectRatio=&quot;xMidYMid slice&quot;</code> 表示 绿色框框 与 显示器的 x 方向、y方向的 中心点 对齐，保持比例放大填满显示屏 后超出部分隐藏；</p><p><img src="https://img11.360buyimg.com/aotucms/jfs/t1/113914/35/9595/221796/5edef024Ec0d99219/e4c1798de6668b20.png" alt="例子3"></p><p>例子4：<code>preserveAspectRatio=&quot;none&quot;</code> 不管三七二十一，随意缩放绿色框框，填满 显示屏即可；这就是非比例缩放的答案了。</p><p><img src="https://img11.360buyimg.com/aotucms/jfs/t1/137386/13/1850/158455/5edef14dEddc2c2cc/a422f4c2615fd20c.png" alt="例子4"></p><h2 id="三、小程序不支持svg标签怎么办" class="post-heading"><a href="#三、小程序不支持svg标签怎么办" class="headerlink" title="三、小程序不支持svg标签怎么办"></a>三、小程序不支持svg标签怎么办<a class="post-anchor" href="#三、小程序不支持svg标签怎么办" aria-hidden="true"></a></h2><p>微信小程序官方不支持 SVG 标签的，但是决定曲线救国，相当于自己实现了一个SVG标签：使用小程序内置的 <code>Canvas</code> 渲染器， 在 <code>Cax</code> 中实现 <code>SVG</code> 标准的子集，使用 <code>JSX</code> 或者 <code>HTM（Hyperscript Tagged Markup）</code> 描述 <code>SVG</code> 结构行为表现。<br><img src="https://img13.360buyimg.com/aotucms/jfs/t1/122876/5/4427/27028/5edef2a3E384682c0/5ea522ad8317fa02.png" alt="今天，小程序正式支持 SVG"></p><p>但是今天我想讲讲其他的。<br>我们知道，小程序虽然不支持 SVG 标签，但是支持 svg 转成 base64 后作为 <code>background-image</code> 的 <code>url</code>，如 <code>background-image: url(&quot;data:image/svg+xml.......)</code> 。</p><p>但是我这边还有个需求，随时更改 SVG 每个路径的颜色，即 颜色可配置：<br><img src="https://img10.360buyimg.com/aotucms/jfs/t1/115005/28/9686/226306/5edef501E42d87ffe/5a462a211ecf8ea0.png" alt="随时更改 SVG 每个路径的颜色"></p><p>来回转 Base64 肯定是比较麻烦的，有没有更好的方式呢？<br><strong>直接贴答案：对于SVG图形，还有更好的实现方式，就是直接使用SVG XML格式代码，无需进行base64转换。</strong></p><h4 id="3-1、URL-编码" class="post-heading"><a href="#3-1、URL-编码" class="headerlink" title="3.1、URL 编码"></a>3.1、URL 编码<a class="post-anchor" href="#3-1、URL-编码" aria-hidden="true"></a></h4><p>直接使用 SVG XML 格式代码，首先要了解 <code>Data URI</code>的格式。<br><strong>划重点：base64非必选项，不指定的时候，后面的 <code>&lt;data&gt;</code> 将使用 URL编码。</strong><br><img src="https://img30.360buyimg.com/aotucms/jfs/t1/137211/36/1825/52183/5edef616E99a0eb6e/643cbb12852b7e47.png" alt></p><h5 id="3-1-1、入门" class="post-heading"><a href="#3-1-1、入门" class="headerlink" title="3.1.1、入门"></a>3.1.1、入门<a class="post-anchor" href="#3-1-1、入门" aria-hidden="true"></a></h5><blockquote><p>百分号编码(Percent-encoding), 也称作URL编码(URL encoding)，是特定上下文的统一资源定位符 (URL)的编码机制。</p></blockquote><p>原理：ASCII 字符 = % + 两位 ASCII 码（十六进制）。<br>例如，字符 a 对应的 ASCII 码为 0x61，那么 URL 编码后得到 %61 。</p><h5 id="3-1-2、URL-编码压缩" class="post-heading"><a href="#3-1-2、URL-编码压缩" class="headerlink" title="3.1.2、URL 编码压缩"></a>3.1.2、URL 编码压缩<a class="post-anchor" href="#3-1-2、URL-编码压缩" aria-hidden="true"></a></h5><p>前言：</p><p><code>Data URI</code> 的格式中的 <code>&lt;data&gt;</code> 完全使用URL 编码也是可以的，如 <code>encodeURIComponent(&#39;&lt;svg version=&quot;1.1&quot; viewBox= …&lt;/svg&gt;&#39;)</code>。<br>但是和转义前原始SVG相比，可读性差了很多，而且占用体积也变大了。<br>如果深入了解URL 编码的话，<code>&lt;data&gt;</code> 没必要全部编码的。</p><p>正文：</p><blockquote><p>RFC3986文档规定，URL中只允许包含 未保留字符 以及 所有保留字符。</p></blockquote><ul><li>未保留字符：包含英文字母（a-zA-Z）、数字（0-9）、-_.~ 4个特殊字符。对于未保留字符，不需要百分号编码。</li><li>保留字符：具有特殊含义的字符 <code>:/?#[]@</code> (分隔Url的协议、主机、路径等组件) 和 <code>!$&amp;&#39;()*+,;=</code> （用于在每个组件中起到分隔作用的，如&amp;符号用于分隔查询多个键值对）。</li><li>受限字符或不安全字符：直接放在Url中的时候，可能会引起解析程序的歧义，因此这部分需要百分号编码，如<code>%</code>、<code>空格</code>、<code>双引号&quot;</code>、<code>尖号 &lt;&gt;</code>等等。</li></ul><p>综上所述，只需要对 受限字符或不安全字符 进行编码即可。</p><ul><li>JS 处理比较简单，利用 replace 将 需要编码的字符 替换掉 即可，基本替换 以下的符号 就够用了：</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">svgToUrl (svgData) &#123;</span><br><span class="line">    encoded = encoded</span><br><span class="line">      .replace(<span class="regexp">/&lt;!--(.*)--&gt;/g</span>, <span class="string">''</span>) <span class="comment">// 亲测必须去掉注释</span></span><br><span class="line">      .replace(<span class="regexp">/[\r\n]/g</span>, <span class="string">' '</span>) <span class="comment">// 亲测最好去掉换行</span></span><br><span class="line">      .replace(<span class="regexp">/"/g</span>, <span class="string">`'`</span>) <span class="comment">// 单引号是保留字符，双引号改成单引号减少编码</span></span><br><span class="line">      .replace(<span class="regexp">/%/g</span>, <span class="string">'%25'</span>)</span><br><span class="line">      .replace(<span class="regexp">/&amp;/g</span>, <span class="string">'%26'</span>)</span><br><span class="line">      .replace(<span class="regexp">/#/g</span>, <span class="string">'%23'</span>)</span><br><span class="line">      .replace(<span class="regexp">/&#123;/g</span>, <span class="string">'%7B'</span>)</span><br><span class="line">      .replace(<span class="regexp">/&#125;/g</span>, <span class="string">'%7D'</span>)</span><br><span class="line">      .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'%3C'</span>)</span><br><span class="line">      .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'%3E'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`data:image/svg+xml,<span class="subst">$&#123;encoded&#125;</span>`</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li><p>如果使用在 CSS 中，可利用 SASS版本3.3以上 的 三个API 对 SVG字符串做替换处理。</p><ol><li><code>str_insert(string, insert, index)</code>： 从 <code>$string</code> 第 <code>$index</code> 插入字符 <code>$insert</code>；</li><li><code>str_index(string, substring)</code>: 返回 <code>$substring</code> 在 <code>$string</code> 中第一个位置；</li><li><p><code>str_slice(string, start_at, end_at = nil)</code>: 返回从字符 <code>$string</code> 中第 <code>$start_at</code> 开始到 <code>$end_at</code> 结束的一个新字符串。</p><p>前人已有总结，可前往 <code>https://github.com/leeenx/sass-svg/blob/master/sass-encodeuri.scss</code> 查看完整代码。</p></li></ol></li></ul><h4 id="3-2、SVG-压缩" class="post-heading"><a href="#3-2、SVG-压缩" class="headerlink" title="3.2、SVG 压缩"></a>3.2、SVG 压缩<a class="post-anchor" href="#3-2、SVG-压缩" aria-hidden="true"></a></h4><p><img src="https://img10.360buyimg.com/aotucms/jfs/t1/117322/1/9804/99241/5edefd7bE190a83a8/95d679fc4af312e9.png" alt="SVGO"></p><p>一般从 Sketch 导出 SVG ，冗余代码比较多，有条件的话建议使用 <a href="https://github.com/svg/svgo" target="_blank" rel="noopener">SVGO</a> 压缩SVG的原本体积，比如清除换行、重复空格；删除文档声明；删除注释；删除desc描述等等。</p><h2 id="四、总结" class="post-heading"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结<a class="post-anchor" href="#四、总结" aria-hidden="true"></a></h2><p><strong>SVG强大的地方在于，出其不意，炫酷，与众不同。</strong></p><p>无论是微信公众号花式排版，foreignObject 标签实现截图，实现非比例缩放，或者 背景图直接使用 SVG XML 格式代码，还是上文没有提及的路径动画、描边动画、图形裁剪、滤镜等等，都可以玩出新的花样。</p><p>SVG 一个属性可成就一篇文章，学习 SVG 可以说是在挑战自己，欢迎加入 SVG 的学习队列。</p><h2 id="五、参考内容-·-推荐阅读" class="post-heading"><a href="#五、参考内容-·-推荐阅读" class="headerlink" title="五、参考内容 · 推荐阅读"></a>五、参考内容 · 推荐阅读<a class="post-anchor" href="#五、参考内容-·-推荐阅读" aria-hidden="true"></a></h2><p><a href="https://aotu.io/notes/2016/11/22/SVG_Web_Animation/">三看 SVG Web 动效</a><br><a href="https://aotu.io/notes/2017/06/15/The-mystery-of-URL-encoding/">URL编码的奥秘</a><br><a href="https://www.zhangxinxu.com/wordpress/2018/08/css-svg-background-image-base64-encode/" target="_blank" rel="noopener">学习了，CSS中内联SVG图片有比Base64更好的形式</a><br><a href="https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/" target="_blank" rel="noopener">超级强大的SVG SMIL animation动画详解</a><br><a href="https://www.jianshu.com/p/8c2e4fc26e8a" target="_blank" rel="noopener">详细教你微信公众号正文页SVG交互开发</a><br><a href="https://www.zhangxinxu.com/wordpress/2017/08/svg-foreignobject/" target="_blank" rel="noopener">SVG<foreignobject>简介与截图等应用</foreignobject></a></p><div class="post-tags" style="display:none"><a href="/tags/svg/">svg</a> <a href="/tags/百分号编码/">百分号编码</a> <a href="/tags/foreignObject/">foreignObject</a> <a href="/tags/iconfont/">iconfont</a> <a href="/tags/viewport/">viewport</a> <a href="/tags/viewBox/">viewBox</a> <a href="/tags/preserveAspectRatio/">preserveAspectRatio</a> <a href="/tags/URL编码/">URL编码</a></div><div class="post-categories" style="display:none"><a href="/cates/Web开发-移动开发/">Web开发 移动开发</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2020/06/09/strong-svg/">https://aotu.io/notes/2020/06/09/strong-svg/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2020-08-25T03:05:37.727Z">上次更新：2020-08-25 11:05:37</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2020/06/22/linearGradient/" title="图形处理：给 Canvas 文本填充线性渐变">图形处理：给 Canvas 文本填充线性渐变 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2020/06/08/momentum-scrolling/" title="前端也要懂物理 —— 惯性滚动篇"><i class="fa fa-chevron-left"></i> 前端也要懂物理 —— 惯性滚动篇</a></div></div><div class="post-comments" id="comments"></div><script>var gitalkOpts={id:"2020-06-09-strong-svg",owner:"o2team",repo:"o2team.github.io",title:"向强大的SVG迈进",body:"https://aotu.io/notes/2020/06/09/strong-svg/index.html\n\n“强大如SVG，走遍千里，海阔天空，过来瞧一瞧看一看啦，大甩卖啦！”",clientID:"3c4d153e6874260f9c7e",clientSecret:"dd44012504c6168bc05b9266e0554bb28c62ce15",admin:["Newcandy"]}</script></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//taro.jd.com" target="_blank" title="Taro">Taro</a></li><li><a href="//taro-ui.jd.com" target="_blank" title="Taro-UI">Taro-UI</a></li><li><a href="//taro-ext.jd.com" target="_blank" title="Taro 物料市场">Taro 物料市场</a></li><li><a href="//taro-club.jd.com" target="_blank" title="Taro 官方论坛">Taro 官方论坛</a></li><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li><li><a href="//aotu.jd.com/share/" target="_blank" title="凹凸公开课">凹凸公开课</a></li><li><a href="//at.aotu.io" target="_blank" title="AT-UI">AT-UI</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://www.cloudbase.net" target="_blank" title="小程序·云开发"><img style="width:22px;vertical-align:middle" src="https://img20.360buyimg.com/ling/jfs/t1/57175/5/15617/50216/5dca6729E00cdff5d/631622525425290e.png">小程序·云开发</a></li><li><a href="https://ling.jd.com" target="_blank" title="京东羚珑智能设计">羚珑智能设计</a></li><li><a href="https://jdrd.jd.com" target="_blank" title="京东零售设计服务平台">京东零售设计服务平台</a></li><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://dopro.io/" target="_blank" title="腾讯 Deep Ocean">Deep Ocean</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li><li><a href="https://uiiiuiii.com/" target="_blank" title="优优教程网">优优教程网</a></li><li><a href="https://www.designup.cn/" target="_blank" title="Designup">Designup</a></li><li><a href="http://eux.baidu.com/" target="_blank" title="百度EUX">百度EUX</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2020. All Rights Reserved.</p><p><a href="http://www.miibeian.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/post_wx_share.js"></script><script src="/js/bundle/gitalk.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript" src="https://tajs.qq.com/stats?sId=53685723" charset="UTF-8"></script></body></html>